(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[8],{QZxW:function(e,t,n){},f0pd:function(e,t,n){"use strict";n.r(t);n("g9YV");var a=n("wCAj"),r=(n("+L6B"),n("2/Rp")),c=n("KQm4"),i=(n("P2fV"),n("NJEC")),l=(n("miYZ"),n("tsqr")),u=n("ODXe"),m=n("q1tI"),s=n.n(m),o=n("o0o1"),p=n.n(o),f=n("HaE+"),d=n("t3Un");function x(){return E.apply(this,arguments)}function E(){return E=Object(f["a"])(p.a.mark((function e(){return p.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(d["a"])("/api/sns/v1/lit/experiment/all_experiments",{method:"GET",params:{}}));case 1:case"end":return e.stop()}}),e)}))),E.apply(this,arguments)}function b(e){return h.apply(this,arguments)}function h(){return h=Object(f["a"])(p.a.mark((function e(t){return p.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(d["a"])("/api/sns/v1/lit/experiment/get_experiments",{method:"GET",params:{exp_name:t.exp_name}}));case 1:case"end":return e.stop()}}),e)}))),h.apply(this,arguments)}function y(e){return _.apply(this,arguments)}function _(){return _=Object(f["a"])(p.a.mark((function e(t){return p.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(d["a"])("/api/sns/v1/lit/experiment/set_experiments?exp_name=".concat(t.exp_name),{method:"POST",data:t.data}));case 1:case"end":return e.stop()}}),e)}))),_.apply(this,arguments)}function v(e){return w.apply(this,arguments)}function w(){return w=Object(f["a"])(p.a.mark((function e(t){return p.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(d["a"])("/api/sns/v1/lit/experiment/delete_experiment",{method:"GET",params:{exp_name:t.exp_name}}));case 1:case"end":return e.stop()}}),e)}))),w.apply(this,arguments)}n("14J3");var k=n("BMrR"),O=(n("giR+"),n("fyUT")),j=(n("jCWc"),n("kPKH")),C=(n("y8nQ"),n("Vl3Y")),I=(n("5NDa"),n("5rEg")),g=(n("iB5I"),n("wlus")),K=n("xvlK"),T=[{required:!0}],V=function(e){var t=Object(m["useRef"])(),n=e.name,a=function(e){var t={},a=0;e.experiments.forEach((function(e){t[e.exp_name]=Number(e.exp_value),a+=t[e.exp_name]})),a>100?l["a"].error("\u6bd4\u4f8b\u8bbe\u7f6e\u9519\u8bef"):y({exp_name:n,data:{value_buckets:t}}).then((function(e){e.success&&l["a"].success("\u66f4\u65b0\u6210\u529f")}))};return Object(m["useEffect"])((function(){b({exp_name:n}).then((function(e){e.success&&t.current.setFieldsValue({experiments:e.data.map((function(e){return{exp_name:e[0],exp_value:e[1]}}))})}))}),[]),s.a.createElement(C["a"],{ref:t,onFinish:a,className:"my-form"},s.a.createElement(C["a"].List,{name:"experiments"},(function(e,t){var n=t.add,a=t.remove;return s.a.createElement("div",null,e.map((function(e,t){return s.a.createElement(k["a"],{key:e.key},s.a.createElement(j["a"],null,s.a.createElement(C["a"].Item,{name:[e.name,"exp_name"],fieldKey:[e.fieldKey,"exp_name"],rules:T},s.a.createElement(I["a"],{placeholder:"\u5b9e\u9a8c\u540d\u79f0"}))),s.a.createElement(j["a"],null,s.a.createElement(C["a"].Item,{name:[e.name,"exp_value"],fieldKey:[e.fieldKey,"exp_value"],rules:T,style:{marginLeft:10}},s.a.createElement(O["a"],{min:0,max:100,placeholder:"\u5b9e\u9a8c\u6bd4\u4f8b"}))),s.a.createElement(j["a"],{flex:"none"},s.a.createElement(g["a"],{style:{marginLeft:10},className:"dynamic-delete-button",onClick:function(){a(e.name)}})))})),s.a.createElement(C["a"].Item,null,s.a.createElement(r["a"],{type:"dashed",onClick:function(){n()},style:{width:"20%"}},s.a.createElement(K["a"],null)," \u589e\u52a0\u5b9e\u9a8c")))})),s.a.createElement(C["a"].Item,null,s.a.createElement(r["a"],{type:"primary",htmlType:"submit"},"Submit")))},F=V,R=(n("2qtc"),n("kLXV")),S=(n("QZxW"),function(e){var t=e.visible,n=e.onCreate,a=e.onCancel,r=C["a"].useForm(),c=Object(u["a"])(r,1),i=c[0];return s.a.createElement(R["a"],{visible:t,title:"\u65b0\u589e\u5b9e\u9a8c",okText:"Create",cancelText:"Cancel",onCancel:a,onOk:function(){i.validateFields().then((function(e){i.resetFields(),n(e)})).catch((function(e){console.log("Validate Failed:",e)}))}},s.a.createElement(C["a"],{form:i,layout:"vertical",name:"form_in_modal",initialValues:{modifier:"public"}},s.a.createElement(C["a"].Item,{name:"exp_name",label:"\u5b9e\u9a8c\u540d\u79f0",rules:[{required:!0,message:"Please input the title of collection!"}]},s.a.createElement(I["a"],null)),s.a.createElement(C["a"].Item,{name:"exp_desc",label:"\u5b9e\u9a8c\u63cf\u8ff0"},s.a.createElement(I["a"],{type:"textarea"}))))}),q=S;function B(e){var t=Object(m["useState"])([]),n=Object(u["a"])(t,2),o=n[0],p=n[1],f=Object(m["useState"])(!1),d=Object(u["a"])(f,2),E=d[0],b=d[1],h=[{title:"\u5b9e\u9a8c\u540d\u5b57",dataIndex:"name",key:"name"},{title:"\u65e5\u671f",dataIndex:"time",key:"time"},{title:"\u5b9e\u9a8c\u5185\u5bb9",dataIndex:"desc",key:"desc"},{title:"Action",dataIndex:"",key:"x",render:function(e,t){return s.a.createElement(i["a"],{title:"Sure to delete?",onConfirm:function(){v({exp_name:t.name}).then((function(e){e.success&&(l["a"].success("delete ok"),p(o.filter((function(e){return e.name!==t.name}))))}))}},s.a.createElement("a",null,"Delete"))}}];Object(m["useEffect"])((function(){x().then((function(e){e.success&&p(e.data.exp_names.map((function(e){return{name:e,time:"--",desc:"--"}})))}))}),[]);var _=function(e){b(!1),y({exp_name:e.exp_name,data:{value_buckets:{default:100}}}).then((function(t){t.success&&(p([].concat(Object(c["a"])(o),[{name:e.exp_name,time:"--",desc:"--"}])),l["a"].success("\u521b\u5efa\u6210\u529f"))}))};return s.a.createElement("div",null,s.a.createElement(r["a"],{type:"primary",onClick:function(){b(!0)},style:{marginBottom:10}},"\u65b0\u589e\u5b9e\u9a8c"),s.a.createElement(q,{visible:E,onCreate:_,onCancel:function(){b(!1)}}),s.a.createElement(a["a"],{columns:h,expandable:{expandedRowRender:function(e){return s.a.createElement(F,{name:e.name})},rowExpandable:function(){return!0}},rowKey:"name",dataSource:o}))}t["default"]=B},iB5I:function(e,t,n){}}]);